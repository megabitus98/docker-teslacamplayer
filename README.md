<!-- DO NOT EDIT THIS FILE MANUALLY -->
<!-- Please read https://github.com/imagegenius/docker-teslacamplayer/blob/main/.github/CONTRIBUTING.md -->

[![GitHub Release](https://img.shields.io/github/release/megabitus98/docker-teslacamplayer.svg?color=007EC6&labelColor=555555&logoColor=ffffff&style=for-the-badge&logo=github)](https://github.com/megabitus98/docker-teslacamplayer/releases)
[![GitHub Package Repository](https://shields.io/badge/GitHub%20Package-blue?logo=github&logoColor=ffffff&style=for-the-badge)](https://github.com/megabitus98/docker-teslacamplayer/packages)

A Blazor WASM application for easily viewing locally stored Tesla sentry & dashcam videos.

> Forked from [imagegenius/docker-teslacamplayer](https://github.com/imagegenius/docker-teslacamplayer), which itself builds on [hydazz/TeslaCamPlayer](https://github.com/hydazz/TeslaCamPlayer).

## Supported Architectures

We use Docker manifest for cross-platform compatibility. More details can be found on [Docker's website](https://distribution.github.io/distribution/spec/manifest-v2-2/#manifest-list).

To obtain the appropriate image for your architecture, simply pull `docker.io/megabitus/teslacamplayer:latest`. Alternatively, you can also obtain specific architecture images by using tags.

This image supports the following architectures:

| Architecture | Available | Tag |
| :----: | :----: | ---- |
| x86-64 | ✅ | \<version tag\>-amd64 |
| arm64 | ✅ | \<version tag\>-arm64 |
| armhf | ❌ | |

## Technologies Used

This project leverages a modern technology stack to provide an efficient and scalable solution for viewing Tesla cam videos:

### Backend Technologies
- **ASP.NET Core 8**: The foundation of the server-side application, providing a robust and high-performance framework for building web applications
- **SignalR**: Enables real-time communication between the server and clients for live updates and notifications
- **SQLite**: Lightweight database for storing clip metadata and application settings
- **FFmpeg**: Essential for video processing and analysis, extracting metadata and handling video formats

### Frontend Technologies
- **Blazor WebAssembly**: Enables building interactive web UIs using C# instead of JavaScript
- **MudBlazor**: Material Design component library for creating responsive and visually appealing interfaces
- **SASS/SCSS**: CSS extension for advanced styling capabilities with variables, nesting, and mixins
- **Gulp**: Build automation tool for processing and optimizing frontend assets

### Containerization & Deployment
- **Docker**: Containerization platform enabling consistent deployment across different environments
- **s6-overlay**: Process supervision and management for containerized applications
- **Ubuntu**: Base Linux distribution for the container runtime
- **Multi-architecture Support**: Images built for x86-64, ARM64, and ARMHF architectures

### Key Features
- Real-time video playback with timeline navigation
- Camera and event filtering capabilities
- Export functionality with retention policies
- Responsive design for various screen sizes
- Secure authentication and authorization mechanisms

## Application Setup

The WebUI can be found at `http://your-ip:5000`, this app is a modified fork of [Rene-Sackers/TeslaCamPlayer](https://github.com/Rene-Sackers/TeslaCamPlayer) with an updated UI, delete button and some other tweaks.

## Windows (Native Executable)

Prefer to run the player directly on Windows? The repository now ships with a publish profile that produces a self-contained `TeslaCamPlayer.BlazorHosted.Server.exe` without needing Docker or a separate .NET runtime.

1. Install the [.NET 8 SDK](https://dotnet.microsoft.com/download).
2. From the repo root run:
   ```bash
   dotnet publish TeslaCamPlayer/src/TeslaCamPlayer.BlazorHosted/Server/TeslaCamPlayer.BlazorHosted.Server.csproj -c Release -p:PublishProfile=win-x64
   ```
3. Open the publish output at `TeslaCamPlayer/src/TeslaCamPlayer.BlazorHosted/Server/bin/Release/net8.0/win-x64/publish`.
4. Update the generated `appsettings.json` (or provide environment variables) so `ClipsRootPath` points to your local TeslaCam folder, e.g. `D:\\TeslaCam`.
5. Keep the folder contents together (the `lib\ffprobe.exe` helper ships alongside the executable), then launch `TeslaCamPlayer.BlazorHosted.Server.exe` and browse to `http://localhost:5000`.

You can zip this folder and move it to another Windows system—everything required to run the app is included in the publish output.

## Usage

Example snippets to start creating a container:

### Docker Compose

```yaml
---
services:
  teslacamplayer:
    image: docker.io/megabitus/teslacamplayer:latest
    container_name: teslacamplayer
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - EXPORT_RETENTION_HOURS=24
      - EXPORT_ROOT_PATH=/export
      - ENABLE_DELETE=false
    volumes:
      - path_to_appdata:/config
      - path_to_teslacam:/media
    ports:
      - 5000:5000
    restart: unless-stopped
```

### Docker CLI ([Click here for more info](https://docs.docker.com/engine/reference/commandline/cli/))

```bash
docker run -d \
  --name=teslacamplayer \
  -e PUID=1000 \
  -e PGID=1000 \
  -e TZ=Etc/UTC \
  -p 5000:5000 \
  -v path_to_appdata:/config \
  -v path_to_teslacam:/media \
  --restart unless-stopped \
  docker.io/megabitus/teslacamplayer:latest
```

## Export retention

Exports dropped into `EXPORT_ROOT_PATH` are trimmed every hour based on `EXPORT_RETENTION_HOURS` (defaults to `24`). Set `EXPORT_RETENTION_HOURS=0` to disable automatic deletion entirely—the service logs at startup whether cleanup is active so you can confirm the setting took effect.

## Parameters

To configure the container, pass variables at runtime using the format `<external>:<internal>`. For instance, `-p 8080:80` exposes port `80` inside the container, making it accessible outside the container via the host's IP on port `8080`.

| Parameter | Function |
| :----: | --- |
| `-p 5000` | WebUI Port |
| `-e PUID=1000` | UID for permissions - see below for explanation |
| `-e PGID=1000` | GID for permissions - see below for explanation |
| `-e TZ=Etc/UTC` | Specify a timezone to use, see this [list](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List). |
| `-v /config` | Appdata Path |
| `-v /media` | Path to your 'TeslaCAM' folder |

## Umask for running applications

All of our images allow overriding the default umask setting for services started within the containers using the optional -e UMASK=022 option. Note that umask works differently than chmod and subtracts permissions based on its value, not adding. For more information, please refer to the Wikipedia article on umask [here](https://en.wikipedia.org/wiki/Umask).

## User / Group Identifiers

To avoid permissions issues when using volumes (`-v` flags) between the host OS and the container, you can specify the user (`PUID`) and group (`PGID`). Make sure that the volume directories on the host are owned by the same user you specify, and the issues will disappear.

Example: `PUID=1000` and `PGID=1000`. To find your PUID and PGID, run `id user`.

```bash
  $ id username
    uid=1000(dockeruser) gid=1000(dockergroup) groups=1000(dockergroup)
```

## Updating the Container

Most of our images are static, versioned, and require an image update and container recreation to update the app. We do not recommend or support updating apps inside the container. Check the [Application Setup](#application-setup) section for recommendations for the specific image.

Instructions for updating containers:

### Via Docker Compose

* Update all images: `docker-compose pull`
  * or update a single image: `docker-compose pull teslacamplayer`
* Let compose update all containers as necessary: `docker-compose up -d`
  * or update a single container: `docker-compose up -d teslacamplayer`
* You can also remove the old dangling images: `docker image prune`

### Via Docker Run

* Update the image: `docker pull ghcr.io/megabitus98/teslacamplayer:latest`
* Stop the running container: `docker stop teslacamplayer`
* Delete the container: `docker rm teslacamplayer`
* Recreate a new container with the same docker run parameters as instructed above (if mapped correctly to a host folder, your `/config` folder and settings will be preserved)
* You can also remove the old dangling images: `docker image prune`

## Versions

* **10.08.24:** - Initial Release.
